(this.webpackJsonpecommerce=this.webpackJsonpecommerce||[]).push([[0],{57:function(t,e,n){},58:function(t,e,n){},70:function(t,e,n){"use strict";n.r(e);var r=n(0),c=n(19),i=n.n(c),s=(n(57),n(24)),a=n(25),o=n(27),u=n(26),l=(n(58),n(11)),d=n(9),j=n(52),h=n(8),b=n(5),m=function(t,e,n,r,c,i){return function(s){fetch("http://localhost:3001/api/v1/carts/".concat(t,"/cart_items"),{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({quantity:e,price:n,title:r,description:c,image:i})}).then((function(t){return t.json()})).then((function(t){return s({type:"ADD_CART_ITEM",cartItem:t.data.attributes,cartItemId:t.data.id,total:t.included[0].attributes.total})})).catch((function(t){return window.alert(t.messages)}))}},p=n(13),g=n(31),O=n(1),f=function(t){var e=Object(d.g)();return Object(O.jsx)("div",{className:"col-sm-4 text-center",children:Object(O.jsxs)(p.a,{style:{width:"18rem",height:"30rem",margin:"20px"},children:[Object(O.jsx)(p.a.Img,{variant:"top",src:t.MainImage.url_170x135,alt:t.title}),Object(O.jsxs)(p.a.Body,{children:[Object(O.jsx)(p.a.Title,{children:t.title}),Object(O.jsxs)(p.a.Text,{children:[t.price,Object(O.jsx)(g.a,{variant:"dark",onClick:function(){if(!sessionStorage.getItem("token"))return window.alert("MUST BE LOGGED IN TO ADD ITEM TO CART"),e.push("/login");t.addToCart(t.cartId,1,t.price,t.title,t.description,t.MainImage.url_75x75)},style:{margin:"5px"},children:"Add To Cart"})]})]})]})})},I=Object(h.b)((function(t){return{cartId:t.cart.id}}),{fetchCreateCartItem:m})((function(t){var e=t.products.map((function(e){return Object(O.jsx)(f,Object(b.a)(Object(b.a)({},e),{},{addToCart:t.fetchCreateCartItem,cartId:t.cartId}),e.listing_id)}));return Object(O.jsx)("div",{className:"row",children:e})})),x=n(22),y=n(28),T=Object(h.b)((function(t){return{firstName:t.customer.first_name,cartItems:t.cartItems,total:t.cart.total}}))((function(t){var e=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"});return Object(O.jsx)(p.a,{style:{width:"18rem",position:"fixed",top:"0",right:"0",margin:"20px"},children:Object(O.jsxs)(p.a.Body,{children:[Object(O.jsxs)(p.a.Title,{children:[t.firstName,"'s Shopping Cart"]}),t.cartItems.length?Object(O.jsxs)(x.a,{children:[Object(O.jsxs)(y.a,{children:["Total ",e.format(t.total)]}),Object(O.jsxs)(y.a,{children:["There are currently ",_(t.cartItems)," item(s) in your cart"]}),Object(O.jsx)(y.a,{children:Object(O.jsx)(l.b,{to:"/cart",children:"View Cart"})})]}):Object(O.jsx)(p.a.Text,{children:"Your cart is currently empty"})]})})})),_=function(t){return t.reduce((function(t,e){return t+e.quantity}),0)},v=function(){if(sessionStorage.token)return Object(O.jsx)(T,{})},N=Object(h.b)((function(t){return{listings:t.listings,loading:t.loading}}))((function(t){var e=Object(r.useState)(""),n=Object(j.a)(e,2),c=n[0],i=n[1],s=t.listings.filter((function(t){return t.title.includes(c)}));return Object(O.jsxs)("div",{children:[Object(O.jsx)(l.b,{to:"/",children:"Home"}),Object(O.jsx)("br",{}),Object(O.jsx)("input",{type:"text",onChange:function(t){return function(t){i(t.target.value)}(t)},name:"text"}),Object(O.jsx)(I,{products:s}),v()]})})),L=n(51),C=Object(h.b)((function(t){return{logIn:t.logIn}}))((function(t){return t.logIn?Object(O.jsx)(L.a,{className:"bg-secondary justify-content-center",style:{padding:"10px",fontSize:"2em"},children:Object(O.jsx)(l.b,{to:"/",onClick:function(){sessionStorage.clear(),t.dispatch({type:"LOG_OUT"})},className:"text-light",children:"Log Out"})}):Object(O.jsxs)("div",{className:"row bg-secondary text-center",style:{padding:"10px",fontSize:"2em"},children:[Object(O.jsx)("div",{className:"col-sm-4"}),Object(O.jsx)("div",{className:"col-sm-2",children:Object(O.jsx)(l.b,{className:"text-light",to:"/login",children:"Log In"})}),Object(O.jsx)("div",{className:"col-sm-2",children:Object(O.jsx)(l.b,{className:"text-light",to:"/register",children:"Register"})}),Object(O.jsx)("div",{className:"col-sm-4"})]})})),S=n(48),w=function(t){return Object(O.jsx)(p.a,{className:"bg-secondary text-center",children:Object(O.jsxs)(p.a.Body,{children:[Object(O.jsx)(p.a.Img,{src:t.image,alt:t.title}),Object(O.jsx)(p.a.Title,{children:t.title}),Object(O.jsx)(p.a.Text,{}),Object(O.jsxs)(l.b,{to:t.route,children:["Search ",t.title]})]})})},E=function(){return Object(O.jsxs)("div",{children:[Object(O.jsx)(C,{}),Object(O.jsx)("br",{}),Object(O.jsx)("br",{}),Object(O.jsx)("div",{children:v()}),Object(O.jsxs)(S.a,{children:[Object(O.jsx)(w,{title:"Trending Listings",route:"/trendingListings",image:"https://i.etsystatic.com/8789900/d/il/c0384b/646853390/il_170x135.646853390_1nbn.jpg?version=1"}),Object(O.jsx)(w,{title:"Interesting Listings",route:"/interestingListings",image:"https://i.etsystatic.com/6196192/d/il/91ad3e/818566630/il_170x135.818566630_fjaj.jpg?version=0"}),Object(O.jsx)(w,{title:"Active Listings",route:"/listings",image:"https://i.etsystatic.com/18538268/c/2250/1788/0/0/il/8f7a20/3052226842/il_170x135.3052226842_ggqf.jpg"})]})]})},A=n(33),D=function(t,e){if(sessionStorage.getItem("token")||sessionStorage.setItem("token",t.token),t.errors)return window.alert(t.errors);var n=t.logIn,r=t.customer.data.id,c=t.customer.data.attributes;e({type:"LOG_IN",customer:{id:r,first_name:c.first_name,last_name:c.last_name,email:c.email},cart:c.cart,cart_items:c.cart_items,orders:c.orders,order_items:c.order_items,logIn:n})},G=function(t){Object(o.a)(n,t);var e=Object(u.a)(n);function n(){var t;Object(s.a)(this,n);for(var r=arguments.length,c=new Array(r),i=0;i<r;i++)c[i]=arguments[i];return(t=e.call.apply(e,[this].concat(c))).state={email:"",password:"",firstName:""},t.handleChange=function(e){t.setState(Object(A.a)({},e.target.name,e.target.value))},t.handleSubmit=function(e){e.preventDefault(),"/login"===t.route?t.props.fetchCustomer(t.state.email,t.state.password):t.props.register(t.state.email,t.state.password,t.state.firstName),t.setState({email:"",password:"",firstName:""})},t.redirectOnLogIn=function(){if(t.props.loggedIn)return Object(O.jsx)(d.a,{to:"/"});var e="/register"===t.route?Object(O.jsx)("input",{onChange:t.handleChange,placeholder:"First Name",type:"text",name:"firstName",value:t.state.firstName}):"";return Object(O.jsxs)("form",{className:"text-center",onSubmit:t.handleSubmit,children:[e,Object(O.jsx)("br",{}),Object(O.jsx)("input",{onChange:t.handleChange,placeholder:"Email",type:"text",name:"email",value:t.state.email}),Object(O.jsx)("br",{}),Object(O.jsx)("input",{onChange:t.handleChange,placeholder:"Password",type:"password",name:"password",value:t.state.password}),Object(O.jsx)("br",{}),Object(O.jsx)("input",{type:"submit",value:"submit"})]})},t}return Object(a.a)(n,[{key:"route",get:function(){return this.props.match.url}},{key:"render",value:function(){return this.redirectOnLogIn()}}]),n}(r.PureComponent),R=Object(h.b)((function(t){return{loggedIn:t.logIn}}),{fetchCustomer:function(t,e){return function(n){fetch("http://localhost:3001/api/v1/sessions",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t,password_digest:e})}).then((function(t){return t.json()})).then((function(t){return D(t,n)})).catch((function(t){return window.alert(t.errors)}))}},register:function(t,e,n){return function(r){fetch("http://localhost:3001/api/v1/customers",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t,password_digest:e,first_name:n})}).then((function(t){return t.json()})).then((function(t){if(t.errors)return window.alert(t.errors);sessionStorage.setItem("token",t.token),r({type:"REGISTER",customer:Object(b.a)({id:t.customer.data.id},t.customer.data.attributes),cart:Object(b.a)({id:t.customer.included[0].id},t.customer.included[0].attributes),logIn:t.logIn})})).catch((function(t){return window.alert(t.errors)}))}}})(G),k=Object(h.b)((function(t){return{trendingListings:t.trendingListings,loading:t.loading}}),{fetchCreateCartItem:m})((function(t){return Object(O.jsxs)("div",{children:[Object(O.jsx)(l.b,{to:"/",children:"Home"}),Object(O.jsx)(I,{products:t.trendingListings}),v()]})})),M=function(t){Object(o.a)(n,t);var e=Object(u.a)(n);function n(){var t;Object(s.a)(this,n);for(var r=arguments.length,c=new Array(r),i=0;i<r;i++)c[i]=arguments[i];return(t=e.call.apply(e,[this].concat(c))).makePurchase=function(){console.log("a"),t.props.createOrderAndItems(t.props.customer.id,t.props.cart,t.props.cartItems),console.log("g"),t.props.emptyCart(t.props.cart.id)},t.items=function(){return t.props.cartItems.map((function(e){return Object(O.jsxs)("div",{className:"col-sm-4 text-center bg-secondary",style:{margin:"20px"},children:[Object(O.jsx)("p",{children:e.title}),Object(O.jsx)("img",{src:e.image,alt:e.title,className:"rounded mx-auto d-block",style:{margin:"5px"},height:"75px",width:"75px"}),Object(O.jsxs)("p",{children:[t.currency.format(e.price)," ",Object(O.jsx)(g.a,{onClick:function(n){return t.props.deleteCartItem(t.props.cart.id,e.id)},style:{margin:"5px"},children:"Remove Item"}),Object(O.jsxs)(x.a,{horizontal:!0,className:"justify-content-center",style:{margin:"5px"},children:[Object(O.jsx)(x.a.Item,{children:"Quantitiy"}),Object(O.jsx)(x.a.Item,{children:e.quantity}),Object(O.jsx)(x.a.Item,{onClick:function(){return t.props.updateCartItemQuantity(t.props.cart.id,e.id,++e.quantity)},children:"+"}),Object(O.jsx)(x.a.Item,{disabled:e.quantity<=1,onClick:function(){return t.props.updateCartItemQuantity(t.props.cart.id,e.id,--e.quantity)},children:"-"})]})]})]},e.id)}))},t.currency=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}),t}return Object(a.a)(n,[{key:"render",value:function(){return Object(O.jsxs)("div",{children:[Object(O.jsx)(l.b,{to:"/",children:"Home"}),Object(O.jsx)("div",{className:"row justify-content-center",children:this.items()}),Object(O.jsxs)("div",{className:"bg-light",style:{position:"fixed",top:"0",right:"0",padding:"10px"},children:[Object(O.jsxs)("h1",{children:[this.props.customer.first_name,"'s Cart"]}),Object(O.jsxs)("h2",{children:["Total ",this.currency.format(this.props.cart.total)," ",Object(O.jsx)(g.a,{onClick:this.makePurchase,children:"Purchase"})]})]})]})}}]),n}(r.PureComponent),U=Object(h.b)((function(t){return{cartItems:t.cartItems,cart:t.cart,customer:t.customer,order:t.order}}),{deleteCartItem:function(t,e){return function(n){fetch("http://localhost:3001/api/v1/carts/".concat(t,"/cart_items/").concat(e),{method:"delete",headers:{"Content-Type":"application/json"}}).then((function(t){return t.json()})).then((function(t){return n({type:"DELETE_CART_ITEM",cartItemId:e,total:t.data.attributes.total})})).catch((function(t){return window.alert(t.messages)}))}},updateCartItemQuantity:function(t,e,n){return function(r){fetch("http://localhost:3001/api/v1/carts/".concat(t,"/cart_items/").concat(e),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({quantity:n})}).then((function(t){return t.json()})).then((function(t){return r({type:"UPDATE_CART_ITEM_QUANTITY",cartItem:t.data.attributes,cartItemId:e,total:t.included[0].attributes.total})})).catch((function(t){return window.alert(t.messages)}))}},createOrderAndItems:function(t,e,n){return console.log("b"),function(r){console.log("c"),fetch("http://localhost:3001/api/v1/customers/".concat(t,"/orders"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Object(b.a)(Object(b.a)({},e),{},{order_items:n}))}).then((function(t){return t.json()})).then((function(t){console.log("d"),r({type:"CREATE_ORDER_AND_ITEMS",order:t.data.attributes,id:t.data.id})})).catch((function(t){return window.alert(t.message)})),console.log("e")}},emptyCart:function(t){return function(e){fetch("http://localhost:3001/api/v1/carts/".concat(t),{method:"PATCH",headers:{"Content-Type":"application/json"}}).then(e({type:"EMPTY_CART"})).catch((function(t){return window.alert(t.message)}))}}})(M),P=n(37),q=n.n(P),F="https://openapi.etsy.com/v2/listings",J="2tegiqsztfabx06i103sm6xy",Q=Object(h.b)((function(t){return{listings:t.interestingListings,loading:t.loading}}))((function(t){return Object(O.jsxs)("div",{children:[Object(O.jsx)(l.b,{to:"/",children:"Home"}),Object(O.jsx)(I,{products:t.listings}),v()]})})),Y=function(t){return Object(O.jsx)(p.a,{style:{width:"18rem"},children:Object(O.jsxs)(p.a.Text,{children:[t.created_at,Object(O.jsx)("br",{}),t.total]})})},B=Object(h.b)((function(t){return{orders:t.orders}}))((function(t){var e=t.orders.map((function(t){return Object(O.jsx)(Y,Object(b.a)({},t),t.id)}));return Object(O.jsx)("div",{className:"row justify-content-center",children:Object(O.jsx)("div",{className:"col-sm-3 text-center",children:e})})})),H=function(t){Object(o.a)(n,t);var e=Object(u.a)(n);function n(){return Object(s.a)(this,n),e.apply(this,arguments)}return Object(a.a)(n,[{key:"componentDidMount",value:function(){sessionStorage.getItem("token")&&this.props.authenticate(),!this.props.listings.length&&this.props.fetchActiveListings(),!this.props.trendingListings.length&&this.props.fetchTrendingListings(),!this.props.interestingListings.length&&this.props.fetchInterestingListings()}},{key:"render",value:function(){return Object(O.jsxs)("div",{children:[Object(O.jsx)("h1",{className:"jumbo text-center text-info",children:"Ecommerce"}),Object(O.jsx)(l.a,{children:Object(O.jsxs)(d.d,{children:[Object(O.jsx)(d.b,{path:"/trendingListings",component:k}),Object(O.jsx)(d.b,{path:"/interestingListings",component:Q}),Object(O.jsx)(d.b,{path:"/listings",component:N}),Object(O.jsx)(d.b,{path:"/cart",component:U}),Object(O.jsx)(d.b,{path:"/login",component:R}),Object(O.jsx)(d.b,{path:"/register",component:R}),Object(O.jsx)(d.b,{path:"/orders/history",component:B}),Object(O.jsx)(d.b,{path:"/",component:E})]})})]})}}]),n}(r.Component),z=Object(h.b)((function(t){return{listings:t.listings,trendingListings:t.trendingListings,interestingListings:t.interestingListings}}),{authenticate:function(){return function(t){fetch("http://localhost:3001/api/v1/customers/authenticate",{headers:Object(b.a)({},sessionStorage)}).then((function(t){return t.json()})).then((function(e){return D(e,t)})).catch((function(t){return window.alert(t)}))}},fetchActiveListings:function(){return function(t){t({type:"LOADING_LISTINGS"}),q()("".concat(F,"/active.js?includes=MainImage&api_key=").concat(J)).then((function(t){return t.json()})).then((function(e){return t({type:"ADD_LISTINGS",listings:e.results})})).catch((function(t){return window.alert(t.message)}))}},fetchTrendingListings:function(){return function(t){t({type:"LOADING_TRENDING_LISTINGS"}),q()("".concat(F,"/trending.js?includes=MainImage&api_key=").concat(J)).then((function(t){return t.json()})).then((function(e){return t({type:"ADD_TRENDING_LISTINGS",listings:e.results})})).catch((function(t){return window.alert(t.message)}))}},fetchInterestingListings:function(){return function(t){t({type:"LOADING_INTERESTING_LISTINGS"}),q()("".concat(F,"/interesting.js?includes=MainImage&api_key=").concat(J)).then((function(t){return t.json()})).then((function(e){return t({type:"ADD_INTERESTING_LISTINGS",listings:e.results})})).catch((function(t){return window.alert(t.message)}))}}})(H),V=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,72)).then((function(e){var n=e.getCLS,r=e.getFID,c=e.getFCP,i=e.getLCP,s=e.getTTFB;n(t),r(t),c(t),i(t),s(t)}))},W=n(20),K=n(49),X=n(50),Z=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"LOG_IN":return e.logIn;case"LOG_OUT":return!1;case"REGISTER":return e.logIn;default:return t}},$=n(6),tt=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"LOADING_LISTINGS":return Object($.a)(t);case"ADD_LISTINGS":var n=e.listings.filter((function(t){return"active"===t.state}));return[].concat(Object($.a)(t),Object($.a)(n));default:return t}},et=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"LOG_IN":return Object(b.a)(Object(b.a)({},t),e.customer);case"LOG_OUT":return{};case"REGISTER":return e.customer;default:return t}},nt=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"LOG_IN":return Object(b.a)(Object(b.a)({},t),e.cart);case"LOG_OUT":return{};case"ADD_CART_ITEM":case"DELETE_CART_ITEM":case"UPDATE_CART_ITEM_QUANTITY":return Object(b.a)(Object(b.a)({},t),{},{total:e.total});case"EMPTY_CART":return Object(b.a)(Object(b.a)({},t),{},{total:0});case"REGISTER":return e.cart;default:return t}},rt=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"LOG_IN":return[].concat(Object($.a)(t),Object($.a)(e.cart_items));case"LOG_OUT":return[];case"ADD_CART_ITEM":return e.cartItem.id=e.cartItemId,[].concat(Object($.a)(t),[e.cartItem]);case"DELETE_CART_ITEM":var n=t.filter((function(t){return t.id!==e.cartItemId}));return n;case"UPDATE_CART_ITEM_QUANTITY":return e.cartItem.id=e.cartItemId,[].concat(Object($.a)(t.filter((function(t){return t.id!==e.cartItemId}))),[e.cartItem]);case"EMPTY_CART":return[];default:return t}},ct=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"LOADING_TRENDING_LISTINGS":return Object($.a)(t);case"ADD_TRENDING_LISTINGS":var n=e.listings.filter((function(t){return"active"===t.state}));return[].concat(Object($.a)(t),Object($.a)(n));default:return t}},it=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"LOG_IN":return[].concat(Object($.a)(t),Object($.a)(e.orders));case"LOG_OUT":return[];case"CREATE_ORDER_AND_ITEMS":return e.order.id=e.id,[].concat(Object($.a)(t),[e.order]);default:return t}},st=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"LOG_IN":return[].concat(Object($.a)(t),Object($.a)(e.order_items));case"LOG_OUT":return[];case"CREATE_ORDER_AND_ITEMS":return[].concat(Object($.a)(t),Object($.a)(e.order.order_items));default:return t}},at=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"LOADING_INTERESTING_LISTINGS":return Object($.a)(t);case"ADD_INTERESTING_LISTINGS":var n=e.listings.filter((function(t){return"active"===t.state}));return[].concat(Object($.a)(t),Object($.a)(n));default:return t}},ot=Object(W.combineReducers)({logIn:Z,customer:et,cart:nt,cartItems:rt,orders:it,orderItems:st,listings:tt,trendingListings:ct,interestingListings:at}),ut=(n(69),Object(W.createStore)(ot,Object(K.composeWithDevTools)(Object(W.applyMiddleware)(X.a))));i.a.render(Object(O.jsx)(h.a,{store:ut,children:Object(O.jsx)(z,{})}),document.getElementById("root")),V()}},[[70,1,2]]]);
//# sourceMappingURL=main.cdd55a83.chunk.js.map